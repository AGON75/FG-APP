
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Joueur - Finger Game</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="container">
    <img src="/logo.png" alt="Logo Finger Game" style="max-height: 80px;" />
    <h1>Bienvenue dans le Finger Game</h1>
    <h2 id="welcome">Chargement...</h2>

    <button onclick="afficherProchaineManche()">üìò Afficher la prochaine manche</button>
    <button onclick="changerDeJoueur()">üîÅ Changer de joueur</button>

    <br><br>
    <a href="/classement.html">üìä Voir le classement</a>
  </div>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const supabaseUrl = 'https://ckolzmqarfizoxjgolft.supabase.co'
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNrb2x6bXFhcmZpem94amdvbGZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk2Nzg3NTYsImV4cCI6MjA2NTI1NDc1Nn0.ZlpERz1uznM0fn--GR9YgM2vjwe_kw-qiPF8KHJvMpI'
    const supabase = createClient(supabaseUrl, supabaseKey)

    let playerId = localStorage.getItem("player_id");

    async function afficherProchaineManche() {
      if (!playerId) return;

      const { data, error } = await supabase
        .from("players")
        .select("*")
        .eq("id", playerId)
        .single();

      if (error || !data) {
        document.getElementById("welcome").textContent = "Joueur non trouv√©.";
      } else {
        document.getElementById("welcome").textContent =
          data.name + " - Piste " + data.terrain + " - Phase " + data.phase + data.round;
      }
    }

    window.changerDeJoueur = function () {
      localStorage.removeItem("player_id");
      window.location.reload();
    }

    afficherProchaineManche();
  </script>
</body>
</html>
