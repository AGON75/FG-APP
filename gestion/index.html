
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>Gestion des Joueurs</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to right, #1e3c72, #9a1c34);
            color: white;
            text-align: center;
            padding: 20px;
        }
        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <img src="../assets/FingerGame_logo_blanc_tagline.png" alt="Logo" style="height: 80px;" />
    <h1>Gestion des Joueurs</h1>
    <input type="text" id="nomPrenom" placeholder="Nom et pr√©nom" />
    <button onclick="ajouterJoueur()">+ Ajouter un joueur</button>
    <div id="joueursContainer"></div>
    <br />
    <button onclick="resetTournoi()">üî• R√©initialiser le tournoi</button>
    <button onclick="supprimerTousLesJoueurs()">‚ùå Supprimer tous les joueurs</button>
    <button onclick="genererFinale()">üèÅ G√©n√©rer la finale (top 5)</button>
    <script>
        const supabaseUrl = 'https://ckolzmqarfizoxjgolf.t.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        async function fetchJoueurs() {
            const { data } = await supabase.from('players').select('*').order('total_points', { ascending: true });
            const container = document.getElementById('joueursContainer');
            container.innerHTML = '';
            data.forEach(joueur => {
                const div = document.createElement('div');
                div.textContent = `${joueur.name} ‚Äî ${joueur.total_points} pts ‚Äî ${joueur.matches} parties ‚Äî Piste ${joueur.terrain}`;
                container.appendChild(div);
            });
        }

        async function ajouterJoueur() {
            const nomPrenom = document.getElementById('nomPrenom').value;
            if (!nomPrenom.trim()) return;
            const numero = Math.floor(Math.random() * 120) + 1;
            await supabase.from('players').insert([{ name: nomPrenom + ' #' + numero }]);
            fetchJoueurs();
        }

        async function resetTournoi() {
            const { data } = await supabase.from('players').select('*');
            for (const joueur of data) {
                await supabase.from('players').update({ total_points: 0, matches: 0 }).eq('id', joueur.id);
            }
            await supabase.from('eliminations').delete().neq('id', '');
            fetchJoueurs();
        }

        async function supprimerTousLesJoueurs() {
            await supabase.from('players').delete().neq('id', '');
            fetchJoueurs();
        }

        async function genererFinale() {
            const { data } = await supabase.from('players').select('*').order('total_points', { ascending: true }).limit(5);
            for (const joueur of data) {
                await supabase.from('players').update({ phase: 5, round: 'F', terrain: 1 }).eq('id', joueur.id);
            }
            fetchJoueurs();
        }

        fetchJoueurs();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</body>
</html>
