const SUPABASE_URL = "https://ckolzmqarfizoxjgolft.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNrb2x6bXFhcmZpem94amdvbGZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk2Nzg3NTYsImV4cCI6MjA2NTI1NDc1Nn0.ZlpERz1uznM0fn--GR9YgM2vjwe_kw-qiPF8KHJvMpI";
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

document.body.innerHTML += `
  <form id="signup-form">
    <input type="text" id="name" placeholder="Ton prénom ou pseudo" required>
    <button type="submit">S'inscrire</button>
  </form>
  <div id="result"></div>
`;

document.getElementById('signup-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const name = document.getElementById('name').value.trim();
  if (!name) return;
  const { error } = await supabase.from('players').insert([{ name, total_points: 0, matches: 0 }]);
  document.getElementById('result').innerText = error ? "❌ " + error.message : "✅ Inscription réussie !";
});

// Affiche le terrain après inscription
function afficherTerrain(terrain) {
  const msg = document.getElementById("terrainMessage");
  if (msg) msg.textContent = "Tu joues sur la piste : " + terrain;
}
window.afficherTerrain = afficherTerrain;
